from pwn import *
from MTRecover import *

r = remote('challs.dvc.tf', 3096)
print(r.recvline())
outputs = []
for i in range(3330):
    r.sendline(b'1')
    output = int(r.recvline().split(b" ")[-1].rstrip())
    outputs.append(output)

mtr = MT19937Recover()
r2 = mtr.go(outputs[-624:])

number = r2.getrandbits(32)
r.sendline(f"{number}".encode())
print(number)
r.interactive()
